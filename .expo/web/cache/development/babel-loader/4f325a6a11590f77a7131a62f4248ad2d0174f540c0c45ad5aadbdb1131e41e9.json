{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport ScreenContainer from \"../components/ScreenContainer\";\nimport Card from \"../components/Card\";\nimport PrimaryButton from \"../components/PrimaryButton\";\nimport { colors, spacing, radius } from \"../theme/theme\";\nimport { enroll, buyCourse } from \"../api/courses\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar API_URL = \"http://192.168.1.42:4000\";\nexport default function CourseDetailScreen(_ref) {\n  var _global$user, _course$creator;\n  var route = _ref.route,\n    navigation = _ref.navigation;\n  var course = route.params.course;\n  var _useState = useState((course.students || []).includes((_global$user = global.user) == null ? void 0 : _global$user.id)),\n    _useState2 = _slicedToArray(_useState, 2),\n    enrolled = _useState2[0],\n    setEnrolled = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  function handleEnroll() {\n    return _handleEnroll.apply(this, arguments);\n  }\n  function _handleEnroll() {\n    _handleEnroll = _asyncToGenerator(function* () {\n      try {\n        setLoading(true);\n        if (course.priceCents === 0) {\n          yield enroll(course._id);\n          setEnrolled(true);\n          Alert.alert(\"Success\", \"You now own this course!\");\n          return;\n        }\n        var data = yield buyCourse(course._id);\n        if (data.url) {\n          Linking.openURL(data.url);\n        } else {\n          Alert.alert(\"Error\", data.error || \"Failed to start checkout\");\n        }\n      } catch (err) {\n        Alert.alert(\"Error\", err.message);\n      } finally {\n        setLoading(false);\n      }\n    });\n    return _handleEnroll.apply(this, arguments);\n  }\n  function openContent() {\n    if (!course.contentUrl) {\n      return Alert.alert(\"No content available\");\n    }\n    Linking.openURL(course.contentUrl);\n  }\n  return _jsxs(ScreenContainer, {\n    scroll: true,\n    children: [_jsx(Text, {\n      style: styles.title,\n      children: course.title\n    }), _jsxs(Card, {\n      style: {\n        marginBottom: spacing(5)\n      },\n      children: [_jsxs(Text, {\n        style: styles.label,\n        children: [\"By: \", ((_course$creator = course.creator) == null ? void 0 : _course$creator.name) || \"Unknown\"]\n      }), _jsx(Text, {\n        style: styles.description,\n        children: course.description\n      }), _jsx(Text, {\n        style: styles.price,\n        children: course.priceCents > 0 ? `$${(course.priceCents / 100).toFixed(2)}` : \"FREE\"\n      }), !enrolled ? _jsx(PrimaryButton, {\n        title: loading ? \"Processing...\" : course.priceCents > 0 ? \"Buy Course\" : \"Enroll\",\n        onPress: handleEnroll,\n        disabled: loading\n      }) : _jsx(PrimaryButton, {\n        title: \"Open Course\",\n        onPress: openContent\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  title: {\n    fontSize: 26,\n    fontWeight: \"700\",\n    marginBottom: spacing(6)\n  },\n  label: {\n    fontSize: 16,\n    fontWeight: \"600\",\n    color: colors.text,\n    marginBottom: spacing(2)\n  },\n  description: {\n    color: colors.textSoft,\n    marginBottom: spacing(4)\n  },\n  price: {\n    fontSize: 20,\n    fontWeight: \"700\",\n    color: colors.accent,\n    marginBottom: spacing(4)\n  }\n});","map":{"version":3,"names":["React","useState","View","Text","TouchableOpacity","StyleSheet","Linking","Alert","Platform","ScreenContainer","Card","PrimaryButton","colors","spacing","radius","enroll","buyCourse","jsx","_jsx","jsxs","_jsxs","API_URL","CourseDetailScreen","_ref","_global$user","_course$creator","route","navigation","course","params","_useState","students","includes","global","user","id","_useState2","_slicedToArray","enrolled","setEnrolled","_useState3","_useState4","loading","setLoading","handleEnroll","_handleEnroll","apply","arguments","_asyncToGenerator","priceCents","_id","alert","data","url","openURL","error","err","message","openContent","contentUrl","scroll","children","style","styles","title","marginBottom","label","creator","name","description","price","toFixed","onPress","disabled","create","fontSize","fontWeight","color","text","textSoft","accent"],"sources":["C:/GrowPathAI-UI/src/screens/CourseDetailScreen.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport {\r\n  View,\r\n  Text,\r\n  TouchableOpacity,\r\n  StyleSheet,\r\n  Linking,\r\n  Alert,\r\n  Platform\r\n} from \"react-native\";\r\nimport ScreenContainer from \"../components/ScreenContainer\";\r\nimport Card from \"../components/Card\";\r\nimport PrimaryButton from \"../components/PrimaryButton\";\r\nimport { colors, spacing, radius } from \"../theme/theme\";\r\nimport { enroll, buyCourse } from \"../api/courses\";\r\n\r\nconst API_URL = \"http://192.168.1.42:4000\";\r\n\r\nexport default function CourseDetailScreen({ route, navigation }) {\r\n  const course = route.params.course;\r\n  const [enrolled, setEnrolled] = useState(\r\n    (course.students || []).includes(global.user?.id)\r\n  );\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  async function handleEnroll() {\r\n    try {\r\n      setLoading(true);\r\n\r\n      if (course.priceCents === 0) {\r\n        // Free course – enroll directly\r\n        await enroll(course._id);\r\n        setEnrolled(true);\r\n        Alert.alert(\"Success\", \"You now own this course!\");\r\n        return;\r\n      }\r\n\r\n      // Paid course – Stripe Checkout\r\n      const data = await buyCourse(course._id);\r\n      if (data.url) {\r\n        Linking.openURL(data.url);\r\n      } else {\r\n        Alert.alert(\"Error\", data.error || \"Failed to start checkout\");\r\n      }\r\n    } catch (err) {\r\n      Alert.alert(\"Error\", err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  function openContent() {\r\n    if (!course.contentUrl) {\r\n      return Alert.alert(\"No content available\");\r\n    }\r\n    Linking.openURL(course.contentUrl);\r\n  }\r\n\r\n  return (\r\n    <ScreenContainer scroll>\r\n      <Text style={styles.title}>{course.title}</Text>\r\n\r\n      <Card style={{ marginBottom: spacing(5) }}>\r\n        <Text style={styles.label}>By: {course.creator?.name || \"Unknown\"}</Text>\r\n\r\n        <Text style={styles.description}>{course.description}</Text>\r\n\r\n        <Text style={styles.price}>\r\n          {course.priceCents > 0\r\n            ? `$${(course.priceCents / 100).toFixed(2)}`\r\n            : \"FREE\"}\r\n        </Text>\r\n\r\n        {!enrolled ? (\r\n          <PrimaryButton\r\n            title={loading ? \"Processing...\" : (course.priceCents > 0 ? \"Buy Course\" : \"Enroll\")}\r\n            onPress={handleEnroll}\r\n            disabled={loading}\r\n          />\r\n        ) : (\r\n          <PrimaryButton title=\"Open Course\" onPress={openContent} />\r\n        )}\r\n      </Card>\r\n    </ScreenContainer>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  title: {\r\n    fontSize: 26,\r\n    fontWeight: \"700\",\r\n    marginBottom: spacing(6)\r\n  },\r\n  label: {\r\n    fontSize: 16,\r\n    fontWeight: \"600\",\r\n    color: colors.text,\r\n    marginBottom: spacing(2)\r\n  },\r\n  description: {\r\n    color: colors.textSoft,\r\n    marginBottom: spacing(4)\r\n  },\r\n  price: {\r\n    fontSize: 20,\r\n    fontWeight: \"700\",\r\n    color: colors.accent,\r\n    marginBottom: spacing(4)\r\n  }\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}